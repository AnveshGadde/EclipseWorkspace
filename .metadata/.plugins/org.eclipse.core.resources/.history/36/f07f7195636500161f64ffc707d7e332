package org.anveshgadde.sql;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.security.InvalidParameterException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.Properties;
import java.util.TimeZone;

public class PythonScript {

	Properties p = new Properties();

	public PythonScript(String path) throws FileNotFoundException, IOException {

		p.load(new FileInputStream(path));

	}

	@SuppressWarnings("finally")
	public static Connection connectDB(Environment environment) {
		Connection connection = null;

		try {
			switch (environment) {
			case DIT:
				connection = PythonScript.getDITRPTOracle();
				break;
			case PROD:

				connection = PythonScript.getProdRPTOracle();
				break;
			case SIT:

				connection = PythonScript.getSITRPTOracle();
				break;
			default:
				throw new InvalidParameterException("Unknown environment: '" + environment + "'");
			}

		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			return connection;
		}

	}

	public static java.sql.Connection getDITRPTOracle() throws Exception {
		java.sql.Connection conn;
		TimeZone timeZone = TimeZone.getTimeZone("GMT");

		TimeZone.setDefault(timeZone);

		try {

			Class.forName("oracle.jdbc.driver.OracleDriver");

		} catch (ClassNotFoundException e) {
			// e.printStackTrace();
			System.exit(-1);
		}

		conn = DriverManager.getConnection("jdbc:oracle:thin:@san-dev-ora-03:1521:DIT", "san_rptaggr52_admin", "san_rptaggr52_admin");
		return conn;

	}

	public static java.sql.Connection getProdRPTOracle() throws Exception {
		java.sql.Connection conn;
		TimeZone timeZone = TimeZone.getTimeZone("GMT");

		TimeZone.setDefault(timeZone);

		try {

			Class.forName("oracle.jdbc.driver.OracleDriver");

		} catch (ClassNotFoundException e) {
			System.exit(-1);
		}

		conn = DriverManager.getConnection("jdbc:oracle:thin:@10.82.0.12:1521:SAVDW102", "SAV_RPT53_READ", "SAV_RPT53_READ");
		return conn;

	}

	public static Connection getSITRPTOracle() throws Exception {
		Connection conn;

		try {

			Class.forName("oracle.jdbc.driver.OracleDriver");

		} catch (ClassNotFoundException e) {
			System.exit(-1);
		}

		conn = DriverManager.getConnection("jdbc:oracle:thin:@san-dev-ora-01:1521:SIT", "san_rpt53_read", "san_rpt53_read");
		return conn;

	}

}
